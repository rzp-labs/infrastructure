{
  "name": "Homelab Infrastructure",
  "image": "mcr.microsoft.com/devcontainers/python:3.12",
  "features": {
    "ghcr.io/devcontainers/features/docker-outside-of-docker:1": {
      "moby": false
    },
    "ghcr.io/devcontainers/features/git:1": {},
    "ghcr.io/devcontainers/features/java:1": {
      "version": "21",
      "installMaven": false,
      "installGradle": false
    }
  },
  "customizations": {
    "vscode": {
      "extensions": [
        // Ansible & YAML
        "redhat.ansible",
        "redhat.vscode-yaml",

        // Python
        "ms-python.python",
        "ms-python.vscode-pylance",
        "charliermarsh.ruff",
        "teticio.python-envy",

        // Shell
        "timonwong.shellcheck",
        "foxundermoon.shell-format",

        // Code Quality & Linting
        "EditorConfig.EditorConfig",
        "codacy-app.codacy",
        "sonarsource.sonarlint-vscode",

        // Git & GitHub
        "eamodio.gitlens",
        "github.vscode-pull-request-github",
        "github.vscode-github-actions",

        // AI Assistants
        "anthropic.claude-code",
        "codeium.windsurfpyright",
        "coderabbit.coderabbit-vscode",
        "google.gemini-cli-vscode-ide-companion",
        "google.geminicodeassist",

        // DevContainers
        "ms-azuretools.vscode-containers",

        // Formatting & Utilities
        "esbenp.prettier-vscode",
        "matthewnespor.vscode-color-identifiers-mode",
        "mechatroner.rainbow-csv",
        "usernamehw.errorlens",
        "mikestead.dotenv",
        "ms-vscode.makefile-tools",

        // UI/Themes
        "miguelsolorio.fluent-icons"
      ],
      "settings": {
        "python.defaultInterpreterPath": "${workspaceFolder}/.venv-container/bin/python",
        "ansible.python.interpreterPath": "${workspaceFolder}/.venv-container/bin/python",
        "ansible.validation.lint.enabled": true,
        "ansible.validation.lint.path": "${workspaceFolder}/.venv-container/bin/ansible-lint",
        "sonarlint.ls.javaHome": "/usr/lib/jvm/java-21-openjdk-arm64",
        "files.associations": {
          "*.yml": "yaml",
          "*.yaml": "yaml"
        },
        "yaml.schemas": {
          "https://json.schemastore.org/ansible-playbook.json": [
            "playbooks/*.yml",
            "playbooks/*.yaml"
          ],
          "https://raw.githubusercontent.com/compose-spec/compose-spec/master/schema/compose-spec.json": [
            "stacks/**/docker-compose.yml",
            "stacks/**/docker-compose.yaml"
          ]
        },
        "yaml.customTags": [
          "!vault"
        ],
        "[yaml]": {
          "editor.insertSpaces": true,
          "editor.tabSize": 2,
          "editor.autoIndent": "advanced",
          "editor.defaultFormatter": "redhat.vscode-yaml"
        }
      }
    }
  },
  "postCreateCommand": "bash .devcontainer/setup.sh",
  "remoteUser": "vscode",
  "containerEnv": {
    "PATH": "/home/vscode/.local/bin:/home/vscode/go/bin:${containerEnv:PATH}",
    "UV_PROJECT_ENVIRONMENT": "/workspaces/infrastructure/.venv-container"
  },
  "mounts": [
    "source=${localEnv:HOME}/.ssh,target=/home/vscode/.ssh,readonly,type=bind",
    "source=${localEnv:HOME}/Library/Group Containers/2BUA8C4S2C.com.1password,target=/home/vscode/.1password,type=bind"
  ],
  "remoteEnv": {
    "SSH_AUTH_SOCK": "/home/vscode/.1password/t/agent.sock"
  }
}

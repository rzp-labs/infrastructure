{
  "name": "Homelab Infrastructure",
  "image": "mcr.microsoft.com/devcontainers/python:3.12",
  "features": {
    "ghcr.io/devcontainers/features/docker-outside-of-docker:1": {
      "moby": false
    },
    "ghcr.io/devcontainers/features/git:1": {}
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "redhat.ansible",
        "redhat.vscode-yaml",
        "ms-python.python",
        "ms-python.vscode-pylance",
        "charliermarsh.ruff",
        "EditorConfig.EditorConfig",
        "timonwong.shellcheck",
        "foxundermoon.shell-format"
      ],
      "settings": {
        "python.defaultInterpreterPath": "/usr/local/bin/python",
        "ansible.python.interpreterPath": "/usr/local/bin/python",
        "files.associations": {
          "*.yml": "yaml",
          "*.yaml": "yaml"
        },
        "yaml.schemas": {
          "https://json.schemastore.org/ansible-playbook.json": [
            "playbooks/*.yml",
            "playbooks/*.yaml"
          ],
          "https://raw.githubusercontent.com/compose-spec/compose-spec/master/schema/compose-spec.json": [
            "stacks/**/docker-compose.yml",
            "stacks/**/docker-compose.yaml"
          ]
        },
        "yaml.customTags": [
          "!vault"
        ],
        "[yaml]": {
          "editor.insertSpaces": true,
          "editor.tabSize": 2,
          "editor.autoIndent": "advanced",
          "editor.defaultFormatter": "redhat.vscode-yaml"
        }
      }
    }
  },
  "postCreateCommand": "bash .devcontainer/setup.sh",
  "remoteUser": "vscode",
  "containerEnv": {
    "PATH": "/home/vscode/.local/bin:/home/vscode/go/bin:${containerEnv:PATH}"
  },
  "mounts": [
    "source=${localEnv:HOME}/.ssh,target=/home/vscode/.ssh,readonly,type=bind",
    "source=${localEnv:HOME}/Library/Group Containers/2BUA8C4S2C.com.1password,target=/home/vscode/.1password,type=bind"
  ],
  "remoteEnv": {
    "SSH_AUTH_SOCK": "/home/vscode/.1password/t/agent.sock"
  }
}
